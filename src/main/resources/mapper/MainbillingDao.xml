<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.trkj.asms.dao.MainbillingDao">
  <resultMap id="BaseResultMap" type="com.trkj.asms.entity.Mainbilling">
    <id column="mainbillingid" jdbcType="INTEGER" property="mainbillingid" />
    <result column="serviceid" jdbcType="INTEGER" property="serviceid" />
    <result column="maintenanceappid" jdbcType="INTEGER" property="maintenanceappid" />
    <result column="kehuid" jdbcType="INTEGER" property="kehuid" />
    <result column="empid" jdbcType="INTEGER" property="empid" />
    <result column="xiangmuid" jdbcType="INTEGER" property="xiangmuid" />
    <result column="cailiaoid" jdbcType="INTEGER" property="cailiaoid" />
    <result column="mendianid" jdbcType="INTEGER" property="mendianid" />
    <result column="chepai" jdbcType="INTEGER" property="chepai" />
    <result column="mainbillingno" jdbcType="VARCHAR" property="mainbillingno" />
    <result column="mainorder" jdbcType="TIMESTAMP" property="mainorder" />
    <result column="mainorderstuta" jdbcType="INTEGER" property="mainorderstuta" />
    <result column="yujisetcar" jdbcType="TIMESTAMP" property="yujisetcar" />
    <result column="yujisetcartime" jdbcType="TIMESTAMP" property="yujisetcartime" />
    <result column="kehudepict" jdbcType="VARCHAR" property="kehudepict" />
    <result column="suichewup" jdbcType="VARCHAR" property="suichewup" />
    <result column="favourable" jdbcType="DECIMAL" property="favourable" />
    <result column="yujiallmony" jdbcType="DECIMAL" property="yujiallmony" />
    <result column="overmonytime" jdbcType="TIMESTAMP" property="overmonytime" />
    <result column="orfanxiu" jdbcType="INTEGER" property="orfanxiu" />
    <result column="beizhu" jdbcType="VARCHAR" property="beizhu" />
    <!--    类型-->
    <association javaType="com.trkj.asms.entity.Service" property="service">
      <result property="serviceid" column="serviceid" jdbcType="INTEGER"/>
      <result property="servicename" column="servicename" jdbcType="VARCHAR"/>
      <result property="state" column="state" jdbcType="INTEGER"/>
    </association>
    <!--    预约-->
    <association javaType="com.trkj.asms.entity.Maintenanceapp" property="maintenanceapp">
      <id column="maintenanceappid" jdbcType="INTEGER" property="maintenanceappid" />
      <result column="serviceid" jdbcType="INTEGER" property="serviceid" />
      <result column="kehuid" jdbcType="INTEGER" property="kehuid" />
      <result column="empid" jdbcType="INTEGER" property="empid" />
      <result column="carid" jdbcType="INTEGER" property="carid" />
      <result column="xiangmuid" jdbcType="INTEGER" property="xiangmuid" />
      <result column="cailiaoid" jdbcType="INTEGER" property="cailiaoid" />
      <result column="mendianid" jdbcType="INTEGER" property="mendianid" />
      <result column="appno" jdbcType="VARCHAR" property="appno" />
      <result column="mainorder" jdbcType="TIMESTAMP" property="mainorder" />
      <result column="mainorderstuta" jdbcType="INTEGER" property="mainorderstuta" />
      <result column="yujiallmony" jdbcType="DECIMAL" property="yujiallmony" />
      <result column="yujisetcar" jdbcType="TIMESTAMP" property="yujisetcar" />
      <result column="yujisetcartime" jdbcType="TIMESTAMP" property="yujisetcartime" />
      <result column="kehudepict" jdbcType="VARCHAR" property="kehudepict" />
      <result column="shiyucause" jdbcType="VARCHAR" property="shiyucause" />
      <result column="beizhu" jdbcType="VARCHAR" property="beizhu" />
    </association>
    <!--    客户-->
    <association javaType="com.trkj.asms.entity.Customer" property="customer">
      <result property="cId" column="c_id" jdbcType="INTEGER"/>
      <result property="cName" column="c_name" jdbcType="VARCHAR"/>
      <result property="sId" column="s_id" jdbcType="INTEGER"/>
      <result property="mId" column="m_id" jdbcType="INTEGER"/>
      <result property="cGender" column="c_gender" jdbcType="VARCHAR"/>
      <result property="cContacts" column="c_contacts" jdbcType="VARCHAR"/>
      <result property="cPhone" column="c_phone" jdbcType="VARCHAR"/>
      <result property="ctId" column="ct_id" jdbcType="INTEGER"/>
      <result property="cAddress" column="c_address" jdbcType="VARCHAR"/>
      <result property="cText" column="c_text" jdbcType="VARCHAR"/>
      <result property="eId" column="e_id" jdbcType="INTEGER"/>
      <result property="cDate" column="c_date" jdbcType="TIMESTAMP"/>
    </association>
    <!--    员工-->
    <association javaType="com.trkj.asms.entity.Emp" property="emp">
      <result property="eId" column="e_Id" jdbcType="INTEGER"/>
      <result property="sId" column="s_id" jdbcType="INTEGER"/>
      <result property="pId" column="p_id" jdbcType="INTEGER"/>
      <result property="dId" column="d_id" jdbcType="INTEGER"/>
      <result property="sex" column="Sex" jdbcType="VARCHAR"/>
      <result property="name" column="Name" jdbcType="VARCHAR"/>
      <result property="loginid" column="LoginID" jdbcType="VARCHAR"/>
      <result property="phone" column="Phone" jdbcType="VARCHAR"/>
      <result property="updatetime" column="UpdateTime" jdbcType="TIMESTAMP"/>
      <result property="updatename" column="UpdateName" jdbcType="VARCHAR"/>
      <result property="deletetime" column="DeleteTime" jdbcType="TIMESTAMP"/>
      <result property="deletename" column="DeleteName" jdbcType="VARCHAR"/>
      <result property="timeliness" column="timeliness" jdbcType="INTEGER"/>
      <result property="createusername" column="CreateUserName" jdbcType="VARCHAR"/>
      <result property="addtime" column="addTime" jdbcType="TIMESTAMP"/>
    </association>
    <!--    项目-->
    <association javaType="com.trkj.asms.entity.Projectsettings" property="projectsettings">
      <result property="pId" column="p_id" jdbcType="INTEGER"/>
      <result property="servetypeid" column="Servetypeid" jdbcType="INTEGER"/>
      <result property="siteid" column="Siteid" jdbcType="INTEGER"/>
      <result property="sId" column="s_id" jdbcType="INTEGER"/>
      <result property="projectcode" column="Projectcode" jdbcType="VARCHAR"/>
      <result property="projectname" column="ProjectName" jdbcType="VARCHAR"/>
      <result property="state" column="State" jdbcType="INTEGER"/>
      <result property="remarks" column="Remarks" jdbcType="VARCHAR"/>
      <result property="typeLabel" column="Type_Label" jdbcType="VARCHAR"/>
      <result property="typeid" column="TypeId" jdbcType="INTEGER"/>
      <result property="workhours" column="WorkHours" jdbcType="VARCHAR"/>
      <result property="custaccountprcie" column="CustAccountPrcie" jdbcType="NUMERIC"/>
      <result property="insideprice" column="InsidePrice" jdbcType="NUMERIC"/>
      <result property="claimantprcie" column="ClaimantPrcie" jdbcType="NUMERIC"/>
    </association>
    <!--    材料-->
    <association javaType="com.trkj.asms.entity.Commodity" property="commodity">
      <id column="co_id" jdbcType="INTEGER" property="coId" />
      <result column="co_name" jdbcType="VARCHAR" property="coName" />
      <result column="co_code" jdbcType="VARCHAR" property="coCode" />
      <result column="s_id" jdbcType="INTEGER" property="sId" />
      <result column="ci_id" jdbcType="INTEGER" property="ciId" />
      <result column="m_id" jdbcType="INTEGER" property="mId" />
      <result column="mu_id" jdbcType="INTEGER" property="muId" />
      <result column="barcode" jdbcType="VARCHAR" property="barcode" />
      <result column="applimodel" jdbcType="VARCHAR" property="applimodel" />
      <result column="is_id" jdbcType="INTEGER" property="isId" />
      <result column="specialmodel" jdbcType="VARCHAR" property="specialmodel" />
      <result column="isinstall" jdbcType="INTEGER" property="isinstall" />
      <result column="w_id" jdbcType="INTEGER" property="wId" />
      <result column="wp_id" jdbcType="INTEGER" property="wpId" />
      <result column="warning" jdbcType="INTEGER" property="warning" />
      <result column="co_retailprice" jdbcType="DECIMAL" property="coRetailprice" />
      <result column="cusprice" jdbcType="DECIMAL" property="cusprice" />
    </association>
    <!--    门店-->
    <association javaType="com.trkj.asms.entity.Store" property="store">
      <result property="sId" column="s_id" jdbcType="INTEGER"/>
      <result property="sNumber" column="s_number" jdbcType="VARCHAR"/>
      <result property="sName" column="s_name" jdbcType="VARCHAR"/>
      <result property="sFullname" column="s_fullname" jdbcType="VARCHAR"/>
      <result property="sLeader" column="s_leader" jdbcType="VARCHAR"/>
      <result property="sAddress" column="s_address" jdbcType="VARCHAR"/>
      <result property="sPhone" column="s_phone" jdbcType="VARCHAR"/>
      <result property="sStatus" column="s_status" jdbcType="INTEGER"/>
    </association>
    <!--   车辆 -->
    <association javaType="com.trkj.asms.entity.Carmanagement" property="carmanagement">
      <result property="carmagid" column="carmagid" jdbcType="INTEGER"/>
      <result property="bId" column="b_id" jdbcType="INTEGER"/>
      <result property="vsId" column="vs_id" jdbcType="INTEGER"/>
      <result property="vId" column="v_id" jdbcType="INTEGER"/>
      <result property="iId" column="i_id" jdbcType="INTEGER"/>
      <result property="bcId" column="bc_id" jdbcType="INTEGER"/>
      <result property="mId" column="m_id" jdbcType="INTEGER"/>
      <result property="sId" column="s_id" jdbcType="INTEGER"/>
      <result property="cId" column="c_id" jdbcType="INTEGER"/>
      <result property="chepai" column="chepai" jdbcType="VARCHAR"/>
      <result property="chejiano" column="chejiano" jdbcType="VARCHAR"/>
      <result property="fadongjino" column="fadongjino" jdbcType="VARCHAR"/>
      <result property="zuoweinumber" column="zuoweinumber" jdbcType="INTEGER"/>
      <result property="buydate" column="buydate" jdbcType="TIMESTAMP"/>
      <result property="daoqiyers" column="daoqiyers" jdbcType="TIMESTAMP"/>
      <result property="newlichen" column="newlichen" jdbcType="INTEGER"/>
      <result property="nextbytime" column="nextbytime" jdbcType="TIMESTAMP"/>
      <result property="nextbylichen" column="nextbylichen" jdbcType="INTEGER"/>
      <result property="yesorno" column="yesorno" jdbcType="VARCHAR"/>
      <result property="beizhu" column="beizhu" jdbcType="VARCHAR"/>
      <result property="jianyi" column="jianyi" jdbcType="VARCHAR"/>
    </association>
  </resultMap>
  <sql id="Base_Column_List">
    mai.mainbillingid, mai.serviceid, mai.maintenanceappid, mai.kehuid, mai.empid, mai.xiangmuid, mai.cailiaoid,
    mai.mendianid, mai.chepai, mai.mainbillingno, mai.mainorder, mai.mainorderstuta, mai.yujisetcar, mai.yujisetcartime,
    mai.kehudepict, mai.suichewup, mai.favourable, mai.yujiallmony, mai.overmonytime, mai.orfanxiu, mai.beizhu
  </sql>
  <sql id="Base_Column_List_ma">
    ma.maintenanceappid, ma.serviceid, ma.kehuid, ma.empid, ma.xiangmuid, ma.cailiaoid, ma.mendianid, ma.appno,
    ma.mainorder, ma.mainorderstuta, ma.yujiallmony, ma.yujisetcar, ma.yujisetcartime, ma.kehudepict, ma.shiyucause,
    ma.beizhu, ma.carid
  </sql>
  <sql id="Base_Column_List_Service">
    se.serviceid,se.servicename,se.state
  </sql>
  <sql id="Base_Column_List_Customer">
    cu.c_id,cu.c_name,cu.s_id,cu.m_id,cu.c_gender,cu.c_contacts,cu.c_phone,cu.ct_id,cu.c_address,cu.c_text,cu.e_id,cu.c_date
  </sql>
  <sql id="Base_Column_List_Emp">
    em.e_Id,em.s_id,em.p_id,em.d_id,em.Sex,em.Name,em.LoginID,em.Phone,em.UpdateTime,em.UpdateName,em.DeleteTime,em.DeleteName,em.timeliness,em.CreateUserName,em.addTime
  </sql>
  <sql id="Base_Column_List_Projectsettings">
    pr.p_id,pr.Servetypeid,pr.Siteid,pr.s_id,pr.Projectcode,pr.ProjectName,pr.State,pr.Remarks,pr.Type_Label,
    pr.TypeId,pr.WorkHours,pr.CustAccountPrcie,pr.InsidePrice,pr.ClaimantPrcie
  </sql>
  <sql id="Base_Column_List_Commodity">
    co.co_id, co.co_name, co.co_code, co.s_id, co.ci_id, co.m_id, co.mu_id, co.barcode, co.applimodel, co.is_id, co.specialmodel,
    co.isinstall, co.w_id, co.wp_id, co.warning, co.co_retailprice, co.cusprice
  </sql>
  <sql id="Base_Column_List_Store">
    st.s_id,st.s_number,st.s_name,st.s_fullname,st.s_leader,st.s_address,st.s_phone,st.s_status
  </sql>
  <sql id="Base_Column_List_Carmanagement">
    ca.carmagid,ca.b_id,ca.vs_id,ca.v_id,ca.i_id,ca.bc_id,ca.s_id,ca.c_id,ca.chepai,ca.chejiano,ca.fadongjino,ca.zuoweinumber,ca.buydate,
    ca.daoqiyers,ca.newlichen,ca.nextbytime,ca.nextbylichen,ca.yesorno,ca.beizhu,ca.jianyi,ca.cjdate
  </sql>
  <select id="selectMainbilling" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />,
    <include refid="Base_Column_List_ma" />,
    <include refid="Base_Column_List_Service" />,
    <include refid="Base_Column_List_Customer" />,
    <include refid="Base_Column_List_Emp" />,
    <include refid="Base_Column_List_Projectsettings" />,
    <include refid="Base_Column_List_Commodity" />,
    <include refid="Base_Column_List_Store" />,
    <include refid="Base_Column_List_Carmanagement" />
    from mainbilling mai
    inner join service se on mai.serviceid = se.serviceid
    inner join customer cu on mai.kehuid = cu.c_id
    inner join emp em on mai.empid = em.e_Id
    inner join projectsettings pr on mai.xiangmuid = pr.p_id
    inner join commodity co on mai.cailiaoid = co.co_id
    inner join store st on mai.mendianid = st.s_id
    inner join carmanagement ca on mai.chepai = ca.carmagid
    inner join maintenanceapp ma on mai.maintenanceappid = ma.maintenanceappid
  </select>
<!--  增加-->
  <insert id="insertMainbilling" parameterType="com.trkj.asms.entity.Mainbilling">
    insert into mainbilling (serviceid,maintenanceappid, kehuid, empid, xiangmuid, cailiaoid, mendianid,chepai,mainbillingno,yujisetcar,
    yujisetcartime,kehudepict,suichewup,favourable,yujiallmony,overmonytime,beizhu)
    values (#{serviceid,jdbcType=INTEGER},#{maintenanceappid,jdbcType=INTEGER},#{kehuid,jdbcType=INTEGER},
    #{empid,jdbcType=INTEGER},#{xiangmuid,jdbcType=INTEGER},#{cailiaoid,jdbcType=INTEGER},#{mendianid,jdbcType=INTEGER},#{chepai,jdbcType=INTEGER},
     #{mainbillingno,jdbcType=VARCHAR}, #{yujisetcar,jdbcType=TIMESTAMP},#{yujisetcartime,jdbcType=TIMESTAMP},#{kehudepict,jdbcType=VARCHAR},#{suichewup,jdbcType=VARCHAR},#{favourable,jdbcType=DECIMAL},
     #{yujiallmony,jdbcType=DECIMAL}, #{overmonytime,jdbcType=TIMESTAMP},#{beizhu,jdbcType=VARCHAR})
  </insert>
<!--  改状态-->
  <update id="updateMainbilling" parameterType="com.trkj.asms.entity.Maintenanceapp">
    update mainbilling
    <set>
      mainorderstuta = 3
    </set>
    where mainbillingid = #{mainbillingid,jdbcType=INTEGER}
  </update>

    <resultMap type="com.trkj.asms.vo.WxmxhzVo" id="WxmxhzVo">
        <result property="sName" column="s_name" jdbcType="VARCHAR"/>
        <result property="mainbilingno" column="mainbillingno" jdbcType="VARCHAR"/>
        <result property="mainorder" column="mainorder" jdbcType="VARCHAR"/>
        <result property="overmonytime" column="overmonytime" jdbcType="VARCHAR"/>
        <result property="cName" column="c_name" jdbcType="NUMERIC"/>
        <result property="cPhone" column="c_phone" jdbcType="VARCHAR"/>
        <result property="chepai" column="chepai" jdbcType="NUMERIC"/>
        <result property="name" column="Name" jdbcType="VARCHAR"/>
        <result property="coName" column="co_name" jdbcType="VARCHAR"/>
        <result property="servicename" column="servicename" jdbcType="VARCHAR"/>
        <result property="settlementType" column="settlement_type" jdbcType="INTEGER"/>
        <result property="mdTitle" column="md_title" jdbcType="VARCHAR"/>
        <result property="amout" column="amout" jdbcType="NUMERIC"/>
        <result property="coRetailprice" column="co_retailprice" jdbcType="NUMERIC"/>
        <result property="amountReceivable" column="AmountReceivable" jdbcType="NUMERIC"/>
        <result property="YFAmount" column="YFAmount" jdbcType="NUMERIC"/>
        <result property="orderamount" column="orderamount" jdbcType="NUMERIC"/>
        <result property="beizhu" column="beizhu" jdbcType="VARCHAR"/>
    </resultMap>
    <resultMap type="com.trkj.asms.vo.WzcghzoVo" id="WzcghzoVo">
        <result property="sName" column="s_name" jdbcType="VARCHAR"/>
        <result property="suppliername" column="suppliername" jdbcType="VARCHAR"/>
        <result property="money" column="money" jdbcType="NUMERIC"/>
        <result property="numberd" column="numberd" jdbcType="INTEGER"/>
        <result property="amout" column="amout" jdbcType="NUMERIC"/>
        <result property="orderamount" column="Orderamount" jdbcType="NUMERIC"/>
        <result property="YFAmount" column="YFAmount" jdbcType="NUMERIC"/>
        <result property="freeAmout" column="FreeAmout" jdbcType="NUMERIC"/>
        <result property="backnumber" column="backnumber" jdbcType="INTEGER"/>
        <result property="yfamount" column="yfamount" jdbcType="NUMERIC"/>
        <result property="amountprice" column="amountprice" jdbcType="NUMERIC"/>
    </resultMap>
    <resultMap type="com.trkj.asms.vo.WzxshzVo" id="WzxshzVo">
        <result property="saleCode" column="sale_code" jdbcType="VARCHAR"/>
        <result property="saleTime" column="sale_time" jdbcType="VARCHAR"/>
        <result property="sName" column="s_name" jdbcType="VARCHAR"/>
        <result property="cName" column="c_name" jdbcType="VARCHAR"/>
        <result property="cPhone" column="c_phone" jdbcType="VARCHAR"/>
        <result property="saleNumber" column="sale_number" jdbcType="INTEGER"/>
        <result property="amout" column="amout" jdbcType="NUMERIC"/>
        <result property="coRetailprice" column="co_retailprice" jdbcType="NUMERIC"/>
    </resultMap>
    <resultMap type="com.trkj.asms.vo.ZjyeVo" id="ZjyeVo">
        <result property="cName" column="c_name" jdbcType="VARCHAR"/>
        <result property="settlementType" column="settlement_type" jdbcType="VARCHAR"/>
        <result property="money" column="money" jdbcType="NUMERIC"/>
        <result property="ssje" column="ssje" jdbcType="NUMERIC"/>
        <result property="zfje" column="zfje" jdbcType="NUMERIC"/>
        <result property="qmje" column="qmje" jdbcType="NUMERIC"/>
    </resultMap>
    <resultMap type="com.trkj.asms.vo.DzmxVo" id="DzmxVo">
        <result property="documentDate" column="DocumentDate" jdbcType="VARCHAR"/>
        <result property="documentNumber" column="DocumentNumber" jdbcType="VARCHAR"/>
        <result property="documentType" column="DocumentType" jdbcType="VARCHAR"/>
        <result property="cname" column="c_name" jdbcType="VARCHAR"/>
        <result property="chepai" column="chepai" jdbcType="VARCHAR"/>
        <result property="settlementType" column="settlement_type" jdbcType="VARCHAR"/>
        <result property="orderamount" column="Orderamount" jdbcType="NUMERIC"/>
        <result property="paidMoney" column="Paid_money" jdbcType="NUMERIC"/>
        <result property="dqye" column="dqye" jdbcType="NUMERIC"/>
        <result property="operator" column="Operator" jdbcType="NUMERIC"/>
        <result property="remarks" column="remarks" jdbcType="NUMERIC"/>
        <result property="x" column="x" jdbcType="VARCHAR"/>
        <result property="c" column="c" jdbcType="INTEGER"/>
        <result property="d" column="d" jdbcType="NUMERIC"/>
        <result property="e" column="e" jdbcType="NUMERIC"/>
        <result property="s" column="s" jdbcType="NUMERIC"/>
        <result property="xfzb" column="xfzb" jdbcType="NUMERIC"/>
        <result property="zje" column="zje" jdbcType="NUMERIC"/>
        <result property="ssje" column="ssje" jdbcType="NUMERIC"/>
        <result property="zfje" column="zfje" jdbcType="NUMERIC"/>
        <result property="yfzk" column="yfzk" jdbcType="NUMERIC"/>
    </resultMap>

    <sql id="Base_Column_List_mainb">
        mainbillingid,serviceid,maintenanceappid,kehuid,empid,xiangmuid,cailiaoid,mendianid,empids,paigongsta,
        mainbillingno,mainorder,mainorderstuta,yujisetcar,yujisetcartime,kehudepict,suichewup,wangongsta,
        favourable,yujiallmony,overmonytime,orfanxiu,beizhu
    </sql>
    <sql id="Base_Column_List_service">
        serviceid,servicename,state
    </sql>
    <sql id="Base_Column_List_maint">
        maintenanceappid, serviceid, kehuid, empid, xiangmuid, cailiaoid, mendianid, carid , appno,
    mainorder, mainorderstuta, yujiallmony, yujisetcar, yujisetcartime, kehudepict, shiyucause,
    beizhu
    </sql>
    <sql id="Base_Column_List_kehu">
        c_id,c_name,s_id,m_id,c_gender,c_contacts,c_phone,ct_id,c_address,c_text,e_id,c_date
    </sql>
    <sql id="Base_Column_List_xiangmu">
        p_id,Servetypeid,Siteid,s_id,Projectcode,ProjectName,State,Remarks,Type_Label,TypeId,WorkHours,
        CustAccountPrcie,InsidePrice,ClaimantPrcie
    </sql>
    <sql id="Base_Column_List_emp">
        e_Id, s_id, p_id, d_id, Sex, Name, LoginID, Phone, UpdateTime, UpdateName, DeleteTime, DeleteName, timeliness, CreateUserName, addTime
    </sql>
    <sql id="Base_Column_List_cailiao">
        co_id,co_name,co_code,s_id,ci_id,m_id,mu_id,barcode,applimodel,is_id,specialmodel,isinstall,
        wh_id,wp_id,warning,co_retailprice,cusprice
    </sql>
    <sql id="Base_Column_List_mendian">
        s_id,s_number,s_name,s_fullname,s_leader,s_address,s_phone,s_status
    </sql>
    <sql id="Base_Column_List_empids">
        e_Id, s_id, p_id, d_id, Sex, Name, LoginID, Phone, UpdateTime, UpdateName, DeleteTime, DeleteName, timeliness, CreateUserName, addTime
    </sql>
    <!--查询单个-->
    <select id="queryById" resultMap="BaseResultMap">
        select
          mainbillingid, serviceid, maintenanceappid, kehuid, empid, xiangmuid, cailiaoid, mendianid, empids, paigongsta, mainbillingno, mainorder, mainorderstuta, yujisetcar, yujisetcartime, kehudepict, suichewup, wangongsta, wangongtime, favourable, yujiallmony, overmonytime, orfanxiu, beizhu
        from asms.mainbilling
        where mainbillingid = #{mainbillingid}
    </select>


    <!--通过实体作为筛选条件查询-->
    <select id="queryAll" resultMap="BaseResultMap">
        select
          mainbillingid, serviceid, maintenanceappid, kehuid, empid, xiangmuid, cailiaoid, mendianid, empids, paigongsta, mainbillingno, mainorder, mainorderstuta, yujisetcar, yujisetcartime, kehudepict, suichewup, wangongsta, wangongtime, favourable, yujiallmony, overmonytime, orfanxiu, beizhu
        from asms.mainbilling
        <where>
            <if test="mainbillingid != null">
                and mainbillingid = #{mainbillingid}
            </if>
            <if test="serviceid != null">
                and serviceid = #{serviceid}
            </if>
            <if test="maintenanceappid != null">
                and maintenanceappid = #{maintenanceappid}
            </if>
            <if test="kehuid != null">
                and kehuid = #{kehuid}
            </if>
            <if test="empid != null">
                and empid = #{empid}
            </if>
            <if test="xiangmuid != null">
                and xiangmuid = #{xiangmuid}
            </if>
            <if test="cailiaoid != null">
                and cailiaoid = #{cailiaoid}
            </if>
            <if test="mendianid != null">
                and mendianid = #{mendianid}
            </if>
            <if test="empids != null">
                and empids = #{empids}
            </if>
            <if test="paigongsta != null">
                and paigongsta = #{paigongsta}
            </if>
            <if test="mainbillingno != null and mainbillingno != ''">
                and mainbillingno = #{mainbillingno}
            </if>
            <if test="mainorder != null">
                and mainorder = #{mainorder}
            </if>
            <if test="mainorderstuta != null">
                and mainorderstuta = #{mainorderstuta}
            </if>
            <if test="yujisetcar != null">
                and yujisetcar = #{yujisetcar}
            </if>
            <if test="yujisetcartime != null">
                and yujisetcartime = #{yujisetcartime}
            </if>
            <if test="kehudepict != null and kehudepict != ''">
                and kehudepict = #{kehudepict}
            </if>
            <if test="suichewup != null and suichewup != ''">
                and suichewup = #{suichewup}
            </if>
            <if test="wangongsta != null">
                and wangongsta = #{wangongsta}
            </if>
            <if test="wangongtime != null">
                and wangongtime = #{wangongtime}
            </if>
            <if test="favourable != null">
                and favourable = #{favourable}
            </if>
            <if test="yujiallmony != null">
                and yujiallmony = #{yujiallmony}
            </if>
            <if test="overmonytime != null">
                and overmonytime = #{overmonytime}
            </if>
            <if test="orfanxiu != null">
                and orfanxiu = #{orfanxiu}
            </if>
            <if test="beizhu != null and beizhu != ''">
                and beizhu = #{beizhu}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="mainbillingid" useGeneratedKeys="true">
        insert into asms.mainbilling(serviceid, maintenanceappid, kehuid, empid, xiangmuid, cailiaoid, mendianid, empids, paigongsta, mainbillingno, mainorder, mainorderstuta, yujisetcar, yujisetcartime, kehudepict, suichewup, wangongsta, wangongtime, favourable, yujiallmony, overmonytime, orfanxiu, beizhu)
        values (#{serviceid}, #{maintenanceappid}, #{kehuid}, #{empid}, #{xiangmuid}, #{cailiaoid}, #{mendianid}, #{empids}, #{paigongsta}, #{mainbillingno}, #{mainorder}, #{mainorderstuta}, #{yujisetcar}, #{yujisetcartime}, #{kehudepict}, #{suichewup}, #{wangongsta}, #{wangongtime}, #{favourable}, #{yujiallmony}, #{overmonytime}, #{orfanxiu}, #{beizhu})
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update asms.mainbilling
        <set>
            <if test="serviceid != null">
                serviceid = #{serviceid},
            </if>
            <if test="maintenanceappid != null">
                maintenanceappid = #{maintenanceappid},
            </if>
            <if test="kehuid != null">
                kehuid = #{kehuid},
            </if>
            <if test="empid != null">
                empid = #{empid},
            </if>
            <if test="xiangmuid != null">
                xiangmuid = #{xiangmuid},
            </if>
            <if test="cailiaoid != null">
                cailiaoid = #{cailiaoid},
            </if>
            <if test="mendianid != null">
                mendianid = #{mendianid},
            </if>
            <if test="empids != null">
                empids = #{empids},
            </if>
            <if test="paigongsta != null">
                paigongsta = #{paigongsta},
            </if>
            <if test="mainbillingno != null and mainbillingno != ''">
                mainbillingno = #{mainbillingno},
            </if>
            <if test="mainorder != null">
                mainorder = #{mainorder},
            </if>
            <if test="mainorderstuta != null">
                mainorderstuta = #{mainorderstuta},
            </if>
            <if test="yujisetcar != null">
                yujisetcar = #{yujisetcar},
            </if>
            <if test="yujisetcartime != null">
                yujisetcartime = #{yujisetcartime},
            </if>
            <if test="kehudepict != null and kehudepict != ''">
                kehudepict = #{kehudepict},
            </if>
            <if test="suichewup != null and suichewup != ''">
                suichewup = #{suichewup},
            </if>
            <if test="wangongsta != null">
                wangongsta = #{wangongsta},
            </if>
            <if test="wangongtime != null">
                wangongtime = #{wangongtime},
            </if>
            <if test="favourable != null">
                favourable = #{favourable},
            </if>
            <if test="yujiallmony != null">
                yujiallmony = #{yujiallmony},
            </if>
            <if test="overmonytime != null">
                overmonytime = #{overmonytime},
            </if>
            <if test="orfanxiu != null">
                orfanxiu = #{orfanxiu},
            </if>
            <if test="beizhu != null and beizhu != ''">
                beizhu = #{beizhu},
            </if>
        </set>
        where mainbillingid = #{mainbillingid}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from asms.mainbilling where mainbillingid = #{mainbillingid}
    </delete>
    <select id="wxmxhz" resultMap="WxmxhzVo">
      SELECT st.s_name,m.mainbillingno,m.mainorder,m.overmonytime,cu.c_name,cu.c_phone,ca.chepai,e.Name,c.co_name,se.servicename,sa.settlement_type,me.md_title,wm.amout,
         c.co_retailprice,car.AmountReceivable,p.YFAmount,d.Orderamount,m.beizhu
	FROM `mainbilling` m
	INNER JOIN `emp` e ON m.mendianid = e.s_id
        INNER JOIN `commodity` c ON c.s_id = m.mendianid
        INNER JOIN `service` se ON se.serviceid = m.serviceid
        INNER JOIN `w_returnedmaterials` wr ON wr.billcode = e.s_id
        INNER JOIN `w_materialorder` wm ON wm.mo_number = wr.billcode
        INNER JOIN `saledetails` sa ON wr.materialname = sa.name
        INNER JOIN `measuringunit` me ON c.mu_id = me.mu_id
        INNER JOIN `duein` d ON d.s_id = m.mendianid
        INNER JOIN `store` st ON m.mendianid = st.s_id
        INNER JOIN `customer` cu ON cu.s_id = st.s_id
        INNER JOIN `carmanagement` ca ON ca.s_id = st.s_id
        INNER JOIN `carwaslist` car ON car.s_id = ca.s_id
        INNER JOIN `pendingpayment` p ON p.s_id = ca.s_id
        WHERE m.mainbillingno != ""
        GROUP BY s_name,mainbillingno,mainorder,overmonytime,c_name,c_phone,chepai,NAME,co_name,servicename,settlement_type,md_title,amout,
        co_retailprice,AmountReceivable,YFAmount,Orderamount,beizhu
        </select>
    <select id="sjcx" resultMap="WxmxhzVo">
        SELECT st.s_name,m.mainbillingno,m.mainorder,m.overmonytime,cu.c_name,cu.c_phone,ca.chepai,e.Name,c.co_name,se.servicename,sa.settlement_type,me.md_title,wm.amout,
         c.co_retailprice,car.AmountReceivable,p.YFAmount,d.Orderamount,m.beizhu
	        FROM `mainbilling` m
	        INNER JOIN `emp` e ON m.mendianid = e.s_id
            INNER JOIN `commodity` c ON c.s_id = m.mendianid
            INNER JOIN `service` se ON se.serviceid = m.serviceid
            INNER JOIN `w_returnedmaterials` wr ON wr.billcode = e.s_id
            INNER JOIN `w_materialorder` wm ON wm.mo_number = wr.billcode
            INNER JOIN `saledetails` sa ON wr.materialname = sa.name
            INNER JOIN `measuringunit` me ON c.mu_id = me.mu_id
            INNER JOIN `duein` d ON d.s_id = m.mendianid
            INNER JOIN `store` st ON m.mendianid = st.s_id
            INNER JOIN `customer` cu ON cu.s_id = st.s_id
            INNER JOIN `carmanagement` ca ON ca.s_id = st.s_id
            INNER JOIN `carwaslist` car ON car.s_id = ca.s_id
            INNER JOIN `pendingpayment` p ON p.s_id = ca.s_id
       WHERE m.mainorder BETWEEN #{param1} and #{param2}
        GROUP BY s_name,mainbillingno,mainorder,overmonytime,c_name,c_phone,chepai,NAME,co_name,servicename,settlement_type,md_title,amout,
        co_retailprice,AmountReceivable,YFAmount,Orderamount,beizhu
        ORDER BY m.mainorder DESC
    </select>
    <select id="wzcghz" resultMap="WzcghzoVo">
      SELECT st.s_name,sup.suppliername,sup.money,wr.numberd,wm.amout,pe.Orderamount,pe.YFAmount,pe.FreeAmout,wr.backnumber,
          wr.amountprice
            FROM  `w_materialorder` wm
            LEFT JOIN `supplier` sup ON wm.suppliername=sup.suppliername
            LEFT JOIN `store` st ON sup.s_id=st.s_id
            LEFT JOIN `w_returnedmaterials` wr ON wm.billcode=wr.billcode
            LEFT JOIN `pendingpayment` pe ON pe.s_id=st.s_id
            LEFT JOIN `refundorder` re ON re.s_id=st.s_id
            GROUP BY s_name,suppliername,money,numberd,amout,Orderamount,backnumber,amountprice,YFAmount,FreeAmout
        </select>
    <select id="wzxshz" resultMap="WzxshzVo">
      SELECT sa.sale_code,pr.sale_time,st.s_name,cu.c_name,cu.c_phone,sa.sale_number,wm.amout,c.co_retailprice
            FROM `saledetails` sa
            LEFT JOIN `productsales` pr ON sa.sale_code=pr.sale_code
            LEFT JOIN `store` st ON st.s_id=sa.md_id
            LEFT JOIN `customer` cu ON pr.c_id=cu.c_id
            LEFT JOIN `supplier` sup ON sup.s_id=sa.md_id
            LEFT JOIN `w_materialorder` wm ON sup.suppliername=wm.suppliername
            LEFT JOIN `commodity` c ON c.s_id=sa.md_id
        </select>
    <select id="zjye" resultMap="ZjyeVo">
      SELECT  cu.c_name,sa.settlement_type,sup.money,SUM(d.Orderamount) AS ssje,SUM(Paid_money) AS zfje,SUM(d.Orderamount)-SUM(Paid_money)AS qmje
         FROM `saledetails` sa
            LEFT JOIN `customer` cu ON cu.c_id = sa.md_id
                LEFT JOIN `supplier` sup ON sup.s_id =sa.md_id
                LEFT JOIN `mainbilling` m ON m.mendianid =sa.md_id
                LEFT JOIN `pendingpayment` p ON m.mainbillingno = p.DocumentNumber
                LEFT JOIN `duein` d ON d.DocumentNumber = p.DocumentNumber
                LEFT JOIN `w_materialorder` wm ON sup.suppliername = wm.suppliername
                GROUP BY settlement_type,c_name,money
        </select>
    <select id="selectnumber" resultMap="DzmxVo">
         SELECT re.DocumentDate,re.DocumentNumber,re.DocumentType,cu.c_name,ca.chepai,sa.settlement_type,d.Orderamount,sup.Paid_money,d.Orderamount-sup.Paid_money AS dqye,re.Operator,re.remarks
            FROM `refundorder` re
            LEFT JOIN `customer` cu ON cu.c_id=re.c_id
            LEFT JOIN `carmanagement` ca ON ca.c_id=re.c_id
            LEFT JOIN `saledetails` sa ON sa.md_id=re.s_id
            LEFT JOIN `mainbilling` m ON m.mendianid =sa.md_id
            LEFT JOIN `pendingpayment` p ON m.mainbillingno = p.DocumentNumber
            LEFT JOIN `duein` d ON d.DocumentNumber = p.DocumentNumber
            LEFT JOIN `supplier` sup ON sup.s_id =sa.md_id
            WHERE sa.settlement_type = #{param1}
    </select>
    <select id="jzlx" resultMap="DzmxVo">
          SELECT (SUM(m.yujiallmony)-SUM(p.WFAmount)) AS zje,SUM(p.Orderamount) AS ssje
            FROM mainbilling m
            LEFT JOIN `pendingpayment` p ON m.mainbillingno = p.DocumentNumber
            LEFT JOIN `duein` d ON d.DocumentNumber = p.DocumentNumber
    </select>
    <select id="jzlx1" resultMap="DzmxVo">
          SELECT SUM(Paid_money) AS zfje,SUM(payablemoney) AS yfzk
            FROM `w_materialorder` wm
            LEFT JOIN `supplier` s ON s.suppliername = wm.suppliername
    </select>
    <select id="flcx" resultMap="WxmxhzVo">
        SELECT st.s_name,m.mainbillingno,m.mainorder,m.overmonytime,cu.c_name,cu.c_phone,ca.chepai,e.Name,c.co_name,se.servicename,sa.settlement_type,me.md_title,wm.amout,
        c.co_retailprice,car.AmountReceivable,p.YFAmount,d.Orderamount,m.beizhu
        FROM `mainbilling` m
        INNER JOIN `emp` e ON m.mendianid = e.s_id
        INNER JOIN `commodity` c ON c.s_id = m.mendianid
        INNER JOIN `service` se ON se.serviceid = m.serviceid
        INNER JOIN `w_returnedmaterials` wr ON wr.billcode = e.s_id
        INNER JOIN `w_materialorder` wm ON wm.mo_number = wr.billcode
        INNER JOIN `saledetails` sa ON wr.materialname = sa.name
        INNER JOIN `measuringunit` me ON c.mu_id = me.mu_id
        INNER JOIN `duein` d ON d.s_id = m.mendianid
        INNER JOIN `store` st ON m.mendianid = st.s_id
        INNER JOIN `customer` cu ON cu.s_id = st.s_id
        INNER JOIN `carmanagement` ca ON ca.s_id = st.s_id
        INNER JOIN `carwaslist` car ON car.s_id = ca.s_id
        INNER JOIN `pendingpayment` p ON p.s_id = ca.s_id
        <where>
            m.mainbillingno != ""
            <if test="cName != null">
              and  cu.c_name LIKE CONCAT('%',#{cName},'%')
            </if>
        </where>
        GROUP BY s_name,mainbillingno,mainorder,overmonytime,c_name,c_phone,chepai,NAME,co_name,servicename,settlement_type,md_title,amout,
        co_retailprice,AmountReceivable,YFAmount,Orderamount,beizhu
    </select>
    <select id="xfjefx" resultMap="DzmxVo">
         SELECT X,c,s,d,xfzb,e FROM
                (SELECT ELT(INTERVAL(yujiallmony,0,200,500,1000,2000,5000,10000),
                '0-200','200-500','500-1000','1000-2000','2000-5000','5000-10000', '10000+')
                AS X ,COUNT(*) c
                FROM mainbilling GROUP BY X) a

                INNER JOIN
                (SELECT ELT(INTERVAL(yujiallmony,0,200,500,1000,2000,5000,10000),
                '0-200','200-500','500-1000','1000-2000','2000-5000','5000-10000', '10000+')
                AS Y ,SUM(yujiallmony) d
                FROM mainbilling GROUP BY Y) b
                ON a.x=b.y

                INNER JOIN
                (SELECT ELT(INTERVAL(yujiallmony,0,200,500,1000,2000,5000,10000),
                '0-200','200-500','500-1000','1000-2000','2000-5000','5000-10000', '10000+')
                AS W ,COUNT(*)/SUM(rs)*COUNT(*) AS s
                FROM
                (SELECT COUNT(*) rs
                FROM mainbilling )g,
                mainbilling GROUP BY W) k
                ON a.x=k.w

                INNER JOIN
                (SELECT ELT(INTERVAL(yujiallmony,0,200,500,1000,2000,5000,10000),
                '0-200','200-500','500-1000','1000-2000','2000-5000','5000-10000', '10000+')
                AS J ,(SUM(yujiallmony)/b.aa) AS xfzb
                FROM mainbilling AS a
                INNER JOIN (SELECT SUM(yujiallmony) AS aa
                FROM mainbilling ) b ON 1=1 GROUP BY J,b.aa)p
                ON a.x=p.J

                INNER JOIN
                (SELECT ELT(INTERVAL(yujiallmony,0,200,500,1000,2000,5000,10000),
                '0-200','200-500','500-1000','1000-2000','2000-5000','5000-10000', '10000+')
                AS Z ,SUM(yujiallmony)/COUNT(*) AS e
                FROM mainbilling GROUP BY Z) f
                ON a.x=f.z
    </select>
</mapper>